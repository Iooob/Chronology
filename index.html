<!DOCTYPE html>
<html>
    <head>
        <title>Exec Error</title>
    </head>
    <body onbeforeunload="save()">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> 
        <script>
            var saveData = true;
            var settings = {
                textFaded: false,
                showTimeList: true,
            }
            var progression = {
                confirmValidCode: true,
                upgrades: {
                    main: {
                        speedUpTime1: {
                        effect: "Doubles the amount of seconds you gain per second.",
                        multi: 2,
                        cost: 10, //Seconds
                        bought: false
                    },
                },
                },
                time: {
                gainTime: 1,
                seconds: {
                    amount: 0,
                },
                showTime: 0,
                breakDown: {
                    seconds: 0,
                    minutes: 0,
                    hours: 0,
                    days: 0,
                    weeks: 0,
                    months: 0,
                    years: 0
                }
            }
            }
            $(function(){
                if(sessionStorage.getItem('loadData') == 'true'){
                    if(localStorage != 'null'){
                        load();
                        preloads();

                    }
                }
            });
            sessionStorage.setItem('loadData', 'true');
            function calcTime(){
                if(progression.time.breakDown.seconds != progression.time.seconds.amount){
                    progression.time.breakDown.seconds = progression.time.seconds.amount;
                    if(progression.time.breakDown.seconds / 3.154e+7 > 1){
                        while(progression.time.breakDown.seconds / 3.154e+7 > 1){
                            progression.time.breakDown.years = Math.floor(progression.time.breakDown.seconds / 3.154e+7);
                            progression.time.breakDown.seconds %= 3.154e+7;
                            progression.time.breakDown.months = 0;
                            progression.time.breakDown.weeks = 0;
                        }
                    }
                    if(progression.time.breakDown.seconds / 2.628e+6	> 1){
                        while(progression.time.breakDown.seconds / 2.628e+6	> 1){
                            progression.time.breakDown.months = Math.floor(progression.time.breakDown.seconds / 2.628e+6);
                            progression.time.breakDown.seconds %= 2.628e+6;
                            progression.time.breakDown.weeks = 0
                            progression.time.breakDown.days = 0;
                        }
                    }
                    if(progression.time.breakDown.seconds / 604800 > 1){
                        while(progression.time.breakDown.seconds / 604800 > 1){
                            progression.time.breakDown.weeks = Math.floor(progression.time.breakDown.seconds / 604800);
                            progression.time.breakDown.seconds %= 604800;
                            progression.time.breakDown.days = 0;
                        }
                    }
                    if(progression.time.breakDown.seconds / 86400 > 1){
                        while(progression.time.breakDown.seconds / 86400 > 1){
                            progression.time.breakDown.days = Math.floor(progression.time.breakDown.seconds / 86400);
                            progression.time.breakDown .seconds%= 86400;
                            progression.time.breakDown.hours = 0;
                        }
                    }
                    if(progression.time.breakDown.seconds / 3600 > 1){
                        while(progression.time.breakDown.seconds / 3600 > 1){
                            progression.time.breakDown.hours = Math.floor(progression.time.breakDown.seconds / 3600);
                            progression.time.breakDown.seconds %= 3600;
                            progression.time.breakDown.minutes = 0;
                        }
                    }
                    if(progression.time.breakDown.seconds / 60 > 1){
                        while(progression.time.breakDown.seconds / 60 > 1){
                            progression.time.breakDown.minutes = Math.floor(progression.time.breakDown.seconds / 60);
                            progression.time.breakDown.seconds %= 60;
                        }
                    }
                }
            }
            function showTime(){
                calcTime();
                document.title = progression.time.seconds.amount.toFixed(0) + " Seconds";
                document.getElementById("tsSec").textContent = progression.time.breakDown.seconds.toFixed(2);
                document.getElementById("tsMin").textContent = progression.time.breakDown.minutes;
                document.getElementById("tsHour").textContent = progression.time.breakDown.hours;
                document.getElementById("tsDay").textContent = progression.time.breakDown.days;
                document.getElementById("tsWeek").textContent = progression.time.breakDown.weeks;
                document.getElementById("tsMonth").textContent = progression.time.breakDown.months;
                document.getElementById("tsYear").textContent = progression.time.breakDown.years;
                document.getElementById("tsTotalSec").textContent = Math.floor(progression.time.seconds.amount);
            }
            function passiveGain(){
                if(progression.time.gainTime < 1000){
                for(var addTime = 0; addTime < progression.time.gainTime; addTime++){
                    progression.time.seconds.amount += 0.1;
                }
                }else if(progression.time.gainTime >= 1000){
                    progression.time.seconds.amount += progression.time.gainTime;
                }
            }
            function preloads(){
                $("#up1").hide();0
                if(settings.showTimeList == false){
                $("#timeContainer").hide();
                $("#totalSec").hide();
                }
                if(settings.textFaded == true){
                    $("#fadeAway1").hide()
                }
            }
            function showTooltips(){
                document.getElementById("up1").innerHTML = progression.upgrades.main.speedUpTime1.effect + "<br>" + "Cost: " + progression.upgrades.main.speedUpTime1.cost + " seconds";
                    $("#upButton1").hover(function(){
                        $("#up1").show(500);
                    },
                    function(){
                        $("#up1").hide(500);
                    });
                    $("#hardReset").hover(function(){
                        $("#resetWarning").css("visibility","visible")
                    },
                    function(){
                        $("#resetWarning").css("visibility","hidden")
                    })   
            }
            function showhideUpgrades(){
                if(progression.upgrades.main.speedUpTime1.bought == false){
                    if(progression.time.seconds.amount >= 10){
                        $("#upButton1").slideDown(500);
                }else{
                    $("#upButton1").slideUp(0);
                }
                    }else{
                        $("#upButton1").slideUp(0);
                    }
                };
            function save(){
                if(saveData === true){
                    const date = new Date();
                    localStorage.setItem('time', JSON.stringify(progression.time));
                    localStorage.setItem('settings',JSON.stringify(settings));
                    localStorage.setItem('upgrades', JSON.stringify(progression.upgrades));
                    localStorage.setItem("leaveDate", date.getTime());
                };
            };
            function exportSave() {
                return(btoa(JSON.stringify(progression)));
            }
            function importSave(save){
                if(JSON.parse(atob(save)).confirmValidCode){
                    progression = JSON.parse(atob(save));
                }
            }
            function load(){
                if(localStorage.getItem("time")){
                progression.time = JSON.parse(localStorage.getItem('time'));
                }
                if(localStorage.getItem("settings")){
                settings = JSON.parse(localStorage.getItem('settings'));
                }
                if(localStorage.getItem("upgrades")){
                progression.upgrades = JSON.parse(localStorage.getItem('upgrades'));    
                };
            }
            function hardReset(){  
                saveData = false;
                localStorage.clear();
                sessionStorage.setItem('loadData','false');
                sessionStorage.setItem('emergencySave', exportSave());
                location.reload()
            };
            function buyUpgrades(){
                $("#upButton1").click(function(){
                    if(progression.upgrades.main.speedUpTime1.bought == false){
                        if(progression.time.seconds.amount >= 10){
                            $("#upButton1").slideUp(500);
                            progression.time.seconds.amount -= 10;
                            progression.upgrades.main.speedUpTime1.bought = true;
                            progression.time.gainTime *= 2;
                        }
                    }
                })
            };
            function pressSettings(){
                //Main Buttons
                $("#settingsButton").click(function(){
                    $("#settingsMenu").show(500);
                })
                $("#closeSettings").click(function(){
                    $("#settingsMenu").hide(250);
                    $("#creditsContainer").css("visibility","hidden")
                })
                //Credits
                $("#creditsButton").click(function(){
                    $("#creditsContainer").css("visibility","visible");
                })
                $("#closeCredits").click(function(){
                    $("#creditsContainer").css("visibility","hidden");
                })
                //Import Export
                $("#exportS").click(function(){
                    document.getElementById("saveText").value = btoa(JSON.stringify(progression))
                })
                $("#importS").click(function(){
                    let saveCode = document.getElementById("saveText").value
                    importSave(saveCode)
                })
                //Hard Reset
                $("#hardReset").click(function(){
                    hardReset();
                })
            };
            $(function(){
                $("#settingsMenu").hide()
                setInterval(showTime,0);
                setInterval(passiveGain,100);
                setInterval(save,60000);
                setInterval(showhideUpgrades,0);
                showTooltips();
                buyUpgrades();
                pressSettings();
                if(sessionStorage.getItem('emergencySave') != 'null' || sessionStorage.getItem('emergencySave' != null)){
                    alert("You have reset your data! An export code has been generated in case you regret your decision \nThis can be accessed from the javascript console Ctrl + Shift + I and its been put in the import/export box")
                    console.log(sessionStorage.getItem('emergencySave'))
                    document.getElementById("saveText").value = btoa(sessionStorage.getItem('emergencySave'))
                    sessionStorage.emergencySave = 'null'

                }
                $("#fadeAway1").fadeOut(5000, function(){
                    settings.textFaded = true;
                });
                $("#timeButton").click(function(){
                    $("#timeContainer").slideToggle(500, function(){
                        if(settings.showTimeList == false){
                        settings.showTimeList = true;
                            }
                        else if(settings.showTimeList == true){
                        settings.showTimeList = false;
                    }
                    });
                    $("#totalSec").slideToggle(500);
                    });
            });

        </script>
        <style>
            body {
                background-color: #101A1C;
            }
            * {
                z-index: 1;
            }
            #infotext1 {
              padding-left: 40%;
              color: white;
            }
            #upgrades {
                padding-left: 2.5%;
                padding-top: 5%;
            }
            .tooltiptext {
                color: #a1b7dd;
                position: absolute;
            }
            #fadeAway1 {
                position: absolute;
                z-index: -1;
            }
            #showTime {
                padding-left: 2.5%;
            }
            .button {
                background-color: #23363A;
                color: white;
                border: outset;
                border-color: #1a2a3f;
                padding: 16px 16px;
                text-decoration: none;
                display: inline-block;
                font-size: 16px;
            }
            #timeContainer {
                background-color: #152124;
                margin-right: 80%;
                color: #a1b7dd;
                border-style: inset;
                border-color: #152132;
                padding-bottom: 0%;
            };
            #totalSecContainer {
                margin-right: 80%;
                color: #a1b7dd;
                border-style: outset;
            }
            #totalSec {
                padding-top: 15px;
                margin-right: 80%;
                height: 50px;
                color: #a1b7dd;
                border-style: outset;
                background-color: #152124;
                border-color: #1a2a3f;
                box-sizing: border-box;
            }
            #tsTotalSec {
                padding-left: 40px;
            }
            .timeSlider {
                display: inline-block;
            }
            #timeList {
                list-style: none;
            };
            #settingsMenu{
                z-index: 69;
            }
            #settingsMenu #settingsContainer {
                color: #a1b7dd;
                position: absolute;
                height: 90%;
                color: #a1b7dd;
                border-style: outset;
                width: 98.5%;
                background-color: #152124;
                border-color: #1a2a3f;
                box-sizing: border-box;
            }
            .settingsContent {
                position: relative;
                margin-left: 20px;
                margin-top: 10px;
            }
            #creditsButton {
                position: absolute;
                bottom: 2.5%;
                left: 0%;
                text-align: center;
            }

            #closeSettings:hover, #settingsButton:hover, .button:hover{
                opacity: 0.6;
            }
            #creditsContainer{
                z-index: 293485;
                visibility: hidden;
                position: absolute;
                top: -2%;
                left: 25%;
                color: #a1b7dd;
                height: 101%;
                border-style: outset;
                width: 40%;
                background-color: #152124;
                border-color: #1a2a3f;
                box-sizing: border-box;
            }
            #creditsContainer a {
                color: #a1b7dd;
            }
            #creditsContainer p, a {
                padding-left: 25px;
            }
            #creditsContainer h1, h2, h3, h4, h5{
                text-align: center;
            }
            .input {
                color: #a1b7dd;
                background-color: #152124;
                border: inset;
                border-color: #1a2a3f
            }
            #saveText{
                display: inline-block;
                line-height: 120%;
            }
            #hardReset {
                position: absolute;
                bottom: 2.5%;
                left: 7.5%;
            }
            #resetWarning {
                visibility: hidden;
                bottom: -50%;
                left: 1.5%;
            }
        </style>
        <div id="infotext1">
            <p id="fadeAway1">You are gaining time. Spend it wisely</p>
        </div>
        <div>
            <!--Settings-->
            <button id="settingsButton" type="submit" style="border:0; background: transparent; position: absolute; right:10px">
                <img src="/images/gear.png"> 
            </button>
            <div id="settingsMenu">
            <div id="settingsContainer">
            <button class="settingsContent button" id="exportS">Export Save</button>
            <button class="settingsContent button" id="importS">Import Save</button> <br>
            <label for="saveText" class="settingsContent">Input/Output</label><br>
            <textarea class="settingsContent input" id="saveText" rows="12" cols="60" style="resize: none"></textarea> <br>
            <button class="settingsContent button" id="hardReset">Hard Reset</button>
            <p class="settingsContent" id="resetWarning">WARNING! This will delete ALL of your progress</p>
            <button class="settingsContent" id="closeSettings" type="submit" style="background: transparent; padding: 0; border: outset; border-color: #1a2a3f; right: 10px; top: 5px; position: absolute">
                <img src="/images/cross.png" style="width: 32px; height: 32px; padding: 0">
            </button>
            <!--Credits (Settings)-->
            <button class="settingsContent button" id="creditsButton">Credits</button>
                <div class="settingsContent" id="creditsContainer">
                    <button class="settingsContent button" id="closeCredits" type="submit" style="background: transparent; padding: 0; border: outset; border-color: #1a2a3f; right: 10px; position: absolute">
                        <img src="/images/cross.png" style="width: 32px; height: 32px; padding: 0">
                    </button>
                    <h1>Credits</h1>
                    <h2>Contributors</h2>
                    <p>Iob - Creator</p> <br>
                    <h2>Icons</h2>
                    <a href="https://www.flaticon.com/free-icons/gear" title="gear icons">Gear icons created by Freepik - Flaticon</a> <br>
                    <a href="https://www.flaticon.com/free-icons/close" title="close icons">Close icons created by Fuzzee - Flaticon</a> <br>
                </div>
            </div>
            </div>
        </div>
        <!--Show how much time has been gained-->
        <div id="showTime">
            <button class="button" id="timeButton">Show Time</button>
                <div id="timeContainer">
                    <ul id="timeList">
                        <li class="timeSlider" id="seconds"> <span id="tsSec"></span> Seconds </li> <br>
                        <li class="timeSlider" id="minutes"> <span id="tsMin"></span> Minutes</li> <br>
                        <li class="timeSlider" id="hours"> <span id="tsHour"></span> Hours</li> <br>
                        <li class="timeSlider" id="days"> <span id="tsDay"></span> Days</li> <br>
                        <li class="timeSlider" id="weeks"> <span id="tsWeek"></span> Weeks</li> <br>
                        <li class="timeSlider" id="months"> <span id="tsMonth"></span> Months</li> <br>
                        <li class="timeSlider" id="years"> <span id="tsYear"></span> Years</li> <br>
                    </ul>
        </div>
        <div id="totalSecContainer">
            <p id="totalSec"><span id="tsTotalSec"></span> <span id="totalSecText"> Seconds</span></p>
        </div>
        </div>
        <!--Upgrades-->
        <div id="upgrades">
            <button class="tooltip upgrade button" id="upButton1" type="input">Speed up time</button>
            <p class="tooltiptext" id="up1"></p>
        </div>
    </body>
</html>
<!-- Cast your card! -->
<!--Comment! -->
<!--What if I put a comment here for every update I do? How many lines would there be?-->
<!--Setings and import/export saves -->